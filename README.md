![Outbound call state machine](https://farm4.staticflickr.com/3694/32869954060_f3c01daa31_z_d.jpg)

This is an extension on Adafruit's [`FONAtest.ino`](https://github.com/adafruit/Adafruit_FONA/blob/master/examples/FONAtest/FONAtest.ino)
example code to allow it to be used with a rotary phone.  The Teensy
2.0 decodes the pulses and implements the state machine to allow you to
place outbound phone calls.  In-bound calls are working, but the ringer
circuit is a work in progress.

The dialtone is generated by the FONA and under control of the teensy,
but ringing and dialing is done by the cell network.  There is not a
proper "off hook" tone in the FONA, so the closest version was used.

Since the entire phone number must be passed to the `ATDT` command
string, the system must try to detect when the user is done dialing.
There is currently a multi-second delay after the last number.

During a call pulses will be translated to DTMF, but the user will
not hear them on the handset.  There is also no comfort tone, which
makes using the phone feel "dead".


Wiring
===
![Inside the phone](https://farm3.staticflickr.com/2808/32833764510_fcd14da721_z_d.jpg)

* Teensy Gnd -> FONA Ground, FONA Key, Phone F (blue?)
* Teensy Vcc -> FONA Vio
* Teensy Pin 0 -> FONA Reset
* Teensy Pin 1 -> Phone RR (green on the dial), rotary dial
* Teensy Pin 2 -> Phone L1 (RJ45 green), hook relay
* Teensy Pin 7 -> FONA RX
* Teensy Pin 8 -> FONA TX

You will need a computer plugged into the Teensy right now
since it doesn't initialize the FONA until the USB serial is
connected.  This will need to be fixed for standalone operation.

Todo
===
![Dialup internet](https://farm4.staticflickr.com/3845/32372052844_b7e6990ddc_z_d.jpg)

* Redial support.
* ~~Incoming call state machine~~ - Done. Incoming calls works (although they play a tone in the speaker)
* Disable headset ring tone.
* Ringer driver circuit. Looks like 15V will engage the bell solenoid, so a simple charge pump and low frequency PWM should do it.
* PCB design to mount FONA, Teensy and wire headers for the phone connections
* Package everything to fit into the phone.
* Buy a red phone, cut a hole for USB charging cable.
* Teensy powered from the battery?  Battery switch?
* Figure out why 300 baud isn't working with the FONA as well as it did with my cellphone.
